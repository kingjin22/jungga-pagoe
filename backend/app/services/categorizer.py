"""
타이틀 기반 카테고리 자동 추론
enum 없이 자유 텍스트 — 새 카테고리는 키워드만 추가하면 됨
"""

# (카테고리 이름, 키워드 리스트) — 위에서부터 매칭
RULES = [
    ("노트북/PC",    ["노트북", "laptop", "맥북", "macbook", "데스크탑", "조립pc", "미니pc", "cpu", "gpu", "그래픽카드", "ssd", "ram", "ddr", "메모리", "파워서플라이"]),
    ("모니터/TV",    ["모니터", "monitor", "tv ", "television", "oled", "qled", "4k", "144hz", "165hz"]),
    ("스마트폰",     ["아이폰", "iphone", "galaxy", "갤럭시", "pixel", "스마트폰", "휴대폰"]),
    ("태블릿",       ["아이패드", "ipad", "갤럭시탭", "tablet", "태블릿"]),
    ("이어폰/헤드폰",["이어폰", "earphone", "earbuds", "헤드폰", "headphone", "buds", "shokz", "jbl", "airpods", "노이즈캔슬링", "anc"]),
    ("카메라",       ["카메라", "camera", "렌즈", "미러리스", "dslr", "gopro", "액션캠"]),
    ("가전",         ["세탁기", "냉장고", "에어컨", "청소기", "로봇청소기", "전자레인지", "오븐", "공기청정기", "가습기", "건조기", "식기세척기", "헤어드라이기"]),
    ("게임",         ["게임", "xbox", "playstation", "ps5", "nintendo", "steam", "닌텐도", "게임기"]),
    ("네트워크",     ["wifi", "router", "공유기", "라우터", "mesh", "wifi7", "wifi6"]),
    ("패션/의류",    ["드로즈", "팬티", "브라", "반팔", "긴팔", "자켓", "코트", "청바지", "레깅스", "운동화", "신발", "가방", "아디다스", "나이키", "언더아머"]),
    ("식품",         ["쌈", "채소", "삼겹", "닭", "소고기", "돼지", "생수", "음료", "과자", "라면", "참치", "김치", "견과", "프로틴", "숙취", "홍삼"]),
    ("뷰티",         ["마스크팩", "선크림", "스킨", "로션", "파운데이션", "올리브영", "샴푸", "린스", "바디워시"]),
    ("홈리빙",       ["주방세제", "세제", "세정", "침구", "이불", "베개", "수건", "청소", "정리함", "선반", "의자", "책상"]),
    ("건강",         ["마스크", "kf94", "영양제", "비타민", "오메가", "유산균", "콜라겐", "단백질"]),
    ("도서",         ["책", "도서", "만화", "소설", "교재", "알라딘", "yes24", "교보"]),
    ("소프트웨어",   ["에픽게임즈", "epic games", "free game", "steam 무료", "구독", "vpn", "antivirus"]),
]


import re as _re


def infer_category(title: str) -> str:
    """타이틀에서 카테고리 자동 추론. 매칭 없으면 '기타'"""
    title_lower = title.lower()
    for category, keywords in RULES:
        for kw in keywords:
            # ASCII 전용 짧은 키워드(4자 이하)는 단어 경계 체크
            if kw.isascii() and len(kw) <= 4:
                if _re.search(r'(?<![a-z0-9])' + _re.escape(kw) + r'(?![a-z0-9])', title_lower):
                    return category
            else:
                if kw in title_lower:
                    return category
    return "기타"
